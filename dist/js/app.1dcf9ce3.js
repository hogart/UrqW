webpackJsonp([1],{0:function(t,e,n){t.exports=n("NHnr")},1:function(t,e){},2:function(t,e){},AqYs:function(t,e,n){t.exports=n.p+"img/logo.1d749ec6.svg"},MiYK:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("/5sW"),i=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("footer",{staticClass:"footer"},[n("div",{staticClass:"container"},[n("p",{staticClass:"text-muted"},[t._v("https://github.com/narmiel/UrqW")])])])}],a=n("XyMi"),o=null,l=!1,u=null,c=null,p=null,h=Object(a["a"])(o,i,r,l,u,c,p),m=h.exports;n("qwQ3"),n("EuXz"),n("mJx5"),n("VjuZ");function f(){}f.prototype.parse=function(t){t=t.replace(/^\s+/,"");var e=t.split(" "),n=e[0].toLowerCase().trim(),s=e.slice(1).join(" ");if("if"!=n){if("btn"==n){var i=s.split(",");if(i.length>1){var r=this.prepareLine(i.slice(1).join(",").trim()),a=i[0].trim();return-1==a.indexOf("&")&&(a=this.openTags(a)),Game.Player.btn(a,r)}}if(t=this.prepareLine(t),e=t.split(" "),n=e[0].toLowerCase().trim(),s=e.slice(1).join(" "),":"!=n[0])switch(n){case"save":return Game.save("fast");case"image":return Game.Player.image(s.toString().trim());case"music":return Game.Player.playMusic(s.toString().trim(),!1);case"play":if(3==volume)return;var o;o=null===files?new Audio("quests/"+Game.name+"/"+s.toString().trim()):new Audio(files[s.toString().trim()]),o.volume=1==volume?1:.5,o.play();break;case"clsb":return Game.Player.clsb();case"cls":return Game.Player.cls();case"forget_procs":return Game.Player.forgetProcs();case"proc":return Game.Player.proc(s.toString().trim());case"end":return Game.Player.end();case"anykey":return Game.Player.anykey(s.toString().trim());case"pause":return Game.Player.pause(parseInt(s));case"input":return Game.Player.input(s.toString().trim());case"quit":return Game.Player.quit();case"invkill":return Game.Player.invkill(s.toString().trim().length>0?s.toString().trim():null);case"perkill":return Game.Player.perkill();case"inv-":var l=s.split(","),u=1;return l.length>1&&(u=parseInt(l[0]),l=l[1]),Game.Player.invRemove(l.toString().trim(),u);case"inv+":return l=s.split(","),u=1,l.length>1&&(u=parseInt(l[0]),l=l[1]),Game.Player.invAdd(l.toString().trim(),u);case"goto":return Game.Player.goto(s.toString().trim(),"goto");case"p":case"print":return Game.Player.print(this.openLinks(s),!1);case"pln":case"println":return Game.Player.print(this.openLinks(s),!0);case"btn":var c=s.split(",");return Game.Player.btn(c[0].trim(),c.slice(1).join(",").trim());case"tokens":var p;p="char"==Game.getVar("tokens_delim")?"":new RegExp("["+Game.getVar("tokens_delim").replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+"]","gi");var h=new Expression(s.trim()).calc().split(p);Game.Player.setVar("tokens_num",h.length);for(var m=0;m<h.length;m++)Game.Player.setVar("token"+(m+1),h[m]);break;case"instr":t=s,t.indexOf("=")>0&&Game.Player.setVar(t.substring(0,t.indexOf("=")).trim(),new Expression("'"+t.substr(t.indexOf("=")+1)+"'").calc());break;default:t.indexOf("=")>0?Game.Player.setVar(t.substring(0,t.indexOf("=")).trim(),new Expression(t.substr(t.indexOf("=")+1)).calc()):console.log("Unknown operand: "+n+" ignored (line: "+t+")")}}else{var f,d,g=t.substring(t.indexOf("if ")+3,t.indexOf(" then ")),v=t;-1!=v.indexOf(" if ")&&(v=v.substring(0,v.indexOf(" if ")+1)),-1==v.indexOf(" else ")?(f=t.substring(t.indexOf(" then ")+6),d=!1):(f=t.substring(t.indexOf(" then ")+6,t.indexOf(" else ")),d=t.substring(t.indexOf(" else ")+6));var y=new Expression(this.openTags(g)).calc();!0===y||y>0?this.parse(f):d&&this.parse(d)}},f.prototype.prepareLine=function(t){var e=t.replace(/\[\[.+?\]\]/g,function(t){return t.replace(/\&/g," ")}).indexOf("&");return-1!=e&&(Game.Player.flowAdd(t.substring(e+1)),t=t.substring(0,e).replace(/^\s+/,"")),this.openTags(t)},f.prototype.openTags=function(t){t=t.replace(/\#\/\$/g,"<br>"),t=t.replace(/\#\%\/\$/g,"<br>"),t=t.replace(/\#\$/g," "),t=t.replace(/\#\%\$/g," "),t=t.replace(/\#\#[^\#]+?\$/g,function(t){return"&#"+t.substr(2,t.length-3)+";"});while(-1!=t.search(/\#[^\#]+?\$/))t=t.replace(/\#[^\#]+?\$/,function(t){t="%"==t[1]?t.substr(2,t.length-3):t.substr(1,t.length-2);var e=new Expression(t).calc();return isFloat(e)?e.toFixed(2):e});return t},f.prototype.openLinks=function(t){while(-1!=t.search(/\[\[.+?\]\]/))t=t.replace(/\[\[.+?\]\]/,function(t){var e,n;if(t=t.substr(2,t.length-4),t.indexOf("|")>0){var s=t.split("|");n=s.slice(1).join("|").trim(),e=s[0].trim()}else n=t.trim(),e=t;return Game.Client.convertToLink(e,Game.Player.link(n))});return t};var d=f,g={name:"home",components:{Footer:m},mounted:function(){}},v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container",attrs:{id:"app"}},[n("router-view"),n("Footer")],1)},y=[];function _(t){n("MiYK")}var b=!1,G=_,A=null,w=null,x=Object(a["a"])(g,v,y,b,G,A,w),C=x.exports,S=n("/ocq"),P={name:"Message",props:{msg:String}},k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-header"},[n("h3",[t._v(t._s(t.msg))])])},L=[],E=!1,T=null,O=null,V=null,I=Object(a["a"])(P,k,L,E,T,O,V),j=I.exports,F=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},q=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{"text-align":"center"},attrs:{id:"logo"}},[s("img",{staticStyle:{opacity:"0.75"},attrs:{width:"150",height:"150",src:n("AqYs")}})])}],U=null,N=!1,Y=null,R=null,Q=null,M=Object(a["a"])(U,F,q,N,Y,R,Q),B=M.exports,D={name:"loadGame",methods:{clicked:function(t){alert(t.currentTarget.textContent)}}},H=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},X=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{display:"none"},attrs:{id:"choose-game"}},[n("div",{staticClass:"page-header"},[n("h3",[t._v("Загрузите игру (если есть дополнительные файлы, необходимо выбрать ВСЕ файлы игры):")]),n("select",{staticClass:"form-control",attrs:{id:"urq_mode"}},[n("option",{attrs:{value:"urqw",selected:""}},[t._v("Не применять специальных правил")]),n("option",{attrs:{value:"ripurq"}},[t._v("Rip URQ 1.4")]),n("option",{attrs:{value:"dosurq"}},[t._v("Dos URQ 1.35")])])]),n("div",{staticClass:"form-group"},[n("input",{attrs:{id:"quest",type:"file",multiple:""}})])])}],W=!1,J=null,K=null,z=null,Z=Object(a["a"])(D,H,X,W,J,K,z),tt=Z.exports,et=n("mtWM"),nt=n.n(et),st={name:"gamelist",data:function(){return{list:[]}},mounted:function(){var t=this;nt.a.get("/games.json").then(function(e){t.list=e.data}).catch(function(t){console.log(t)})}},it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._m(0),n("div",{staticClass:"list-group gamelist"},t._l(t.list,function(e){return n("router-link",{key:e.folder,attrs:{to:{name:"game",params:{name:e.folder}}}},[n("h2",{staticClass:"title"},[t._v(t._s(e.title))]),n("h4",[t._v(t._s(e.description))]),n("h4",[t._v(t._s(e.author))])])}))])},rt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-header"},[n("h3",[t._v("Или выберите игру из списка:")])])}],at=!1,ot=null,lt=null,ut=null,ct=Object(a["a"])(st,it,rt,at,ot,lt,ut),pt=ct.exports,ht=n("WgY6"),mt=n.n(ht),ft={name:"Zip"},dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},gt=[],vt=!1,yt=null,_t=null,bt=null,Gt=Object(a["a"])(ft,dt,gt,vt,yt,_t,bt),At=(Gt.exports,{name:"home",components:{Message:j,Logo:B,LoadGame:tt,GameList:pt},data:function(){return{message:"Загрузка..."}},mounted:function(){this.message=!1},methods:{clicked:function(t){alert(t.currentTarget.textContent)}}}),wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Logo"),t.message?n("Message",{attrs:{msg:t.message}}):t._e(),n("button",{on:{click:t.clicked}},[t._v("Event2")]),n("LoadGame"),n("GameList")],1)},xt=[],Ct=!1,St=null,Pt=null,kt=null,Lt=Object(a["a"])(At,wt,xt,Ct,St,Pt,kt),Et=Lt.exports,Tt=(n("y9m4"),n("WpTh"),function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)}),Ot=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("nav",{staticClass:"navbar navbar-default"},[n("a",{staticClass:"navbar-brand ",attrs:{href:"index.html"}},[n("span",{staticStyle:{"margin-right":"5px"}},[n("img",{staticStyle:{opacity:"0.65"},attrs:{height:"24",width:"24",alt:"Brand",src:"logo.svg"}})]),n("span",{staticClass:"hidden-xs"},[t._v(" UrqW")])]),n("ul",{staticClass:"nav navbar-nav"},[n("li",[n("a",{attrs:{title:"Управление громкостью",id:"mute",href:"#"}},[n("span",{staticClass:"glyphicon glyphicon-volume-up",attrs:{"aria-hidden":"true"}},[n("span",{staticClass:"hint sr-only"},[t._v("Убавить звук")])])])]),n("li",[n("a",{attrs:{title:"Перезапустить игру",id:"restart",href:"#"}},[n("span",{staticClass:"glyphicon glyphicon-refresh",attrs:{"aria-hidden":"true"}},[n("span",{staticClass:"hint sr-only"},[t._v("Перезапустить игру")])])])]),n("li",[n("a",{attrs:{title:"Сохранить игру",id:"save",href:"#"}},[n("span",{staticClass:"glyphicon glyphicon-floppy-disk",attrs:{"aria-hidden":"true"}},[n("span",{staticClass:"hint sr-only"},[t._v("Сохранить игру")])])])]),n("li",[n("a",{attrs:{title:"Загрузить игру",id:"load",href:"#"}},[n("span",{staticClass:"glyphicon glyphicon-folder-open",attrs:{"aria-hidden":"true"}},[n("span",{staticClass:"hint sr-only"},[t._v("Загрузить игру")])])])])]),n("ul",{staticClass:"nav navbar-nav navbar-right"},[n("li",{staticClass:"dropdown"},[n("a",{staticClass:"dropdown-toggle hidden-xs",attrs:{href:"#","data-toggle":"dropdown",role:"button","aria-haspopup":"true","aria-expanded":"false"}},[t._v("Инвентарь "),n("span",{staticClass:"caret"})]),n("a",{staticClass:"dropdown-toggle visible-xs",attrs:{href:"#","data-toggle":"dropdown",role:"button","aria-haspopup":"true","aria-expanded":"false"}},[n("span",{staticClass:"glyphicon glyphicon-th-list"})]),n("ul",{staticClass:"dropdown-menu dropdown-menu-left",attrs:{id:"inventory"}},[n("li",[n("a",{staticClass:"item_use",attrs:{href:"#"}},[t._v("(Пусто)")])])])])])])}],Vt=null,$t=!1,It=null,jt=null,Ft=null,qt=Object(a["a"])(Vt,Tt,Ot,$t,It,jt,Ft),Ut=qt.exports,Nt={name:"buttons",props:{buttons:Array},methods:{clicked:function(t){this.$emit("clicked",t)}}},Yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.buttons&&t.buttons.length?n("div",t._l(t.buttons,function(e){return n("button",{key:e.id,domProps:{innerHTML:t._s(e.desc)},on:{click:function(n){t.clicked(e.id)}}})})):t._e()},Rt=[],Qt=!1,Mt=null,Bt=null,Dt=null,Ht=Object(a["a"])(Nt,Yt,Rt,Qt,Mt,Bt,Dt),Xt=Ht.exports,Wt={name:"contentText",props:{content:Array}},Jt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.content&&t.content.length?n("div",t._l(t.content,function(e){return n("div",{style:{color:e[3]?"#fff":"#000"},domProps:{innerHTML:t._s(e[0])}})})):t._e()},Kt=[],zt=!1,Zt=null,te=null,ee=null,ne=Object(a["a"])(Wt,Jt,Kt,zt,Zt,te,ee),se=ne.exports,ie=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},re=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group",staticStyle:{display:"none"},attrs:{id:"input"}},[n("input",{staticClass:"form-control",attrs:{type:"text"}}),n("span",{staticClass:"input-group-btn"},[n("button",{staticClass:"btn btn-default",attrs:{id:"input_enter",type:"button"}},[t._v("Ок")])])])}],ae=null,oe=!1,le=null,ue=null,ce=null,pe=Object(a["a"])(ae,ie,re,oe,le,ue,ce),he=pe.exports,me=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},fe=[],de=null,ge=!1,ve=null,ye=null,_e=null,be=Object(a["a"])(de,me,fe,ge,ve,ye,_e),Ge=be.exports,Ae=n("UBQj"),we=n.n(Ae),xe=function(t){switch(t>15&&(t%=16),t){case 0:return"#000000";case 1:return"#0000AA";case 2:return"#00AA00";case 3:return"#00AAAA";case 4:return"#AA0000";case 5:return"#AA00AA";case 6:return"#AA5500";case 7:return"#AAAAAA";case 8:return"#555555";case 9:return"#5555FF";case 10:return"#55FF55";case 11:return"#55FFFF";case 12:return"#FF5555";case 13:return"#FF55FF";case 14:return"#FFFF55";case 15:return"#FFFFFF";default:return"#000000"}},Ce=function(t){return t===Number(t)&&t%1!==0};function Se(t){for(var e=unescape("%u0402%u0403%u201A%u0453%u201E%u2026%u2020%u2021%u20AC%u2030%u0409%u2039%u040A%u040C%u040B%u040F%u0452%u2018%u2019%u201C%u201D%u2022%u2013%u2014%u0000%u2122%u0459%u203A%u045A%u045C%u045B%u045F%u00A0%u040E%u045E%u0408%u00A4%u0490%u00A6%u00A7%u0401%u00A9%u0404%u00AB%u00AC%u00AD%u00AE%u0407%u00B0%u00B1%u0406%u0456%u0491%u00B5%u00B6%u00B7%u0451%u2116%u0454%u00BB%u0458%u0405%u0455%u0457"),n=function(t){return t>=192&&t<=255?String.fromCharCode(t-192+1040):t>=128&&t<=191?e.charAt(t-128):String.fromCharCode(t)},s="",i=0;i<t.length;i++)s+=n(t.charCodeAt(i));return s}var Pe=[];Pe["bmp"]="image/bmp",Pe["gif"]="image/gif",Pe["jpg"]="image/jpeg",Pe["jpeg"]="image/jpeg",Pe["png"]="image/png",Pe["mid"]="audio/midi",Pe["midi"]="audio/midi",Pe["mp3"]="audio/mp3";var ke={dosColorToHex:xe,isFloat:Ce,win2unicode:Se,MIME:Pe};function Le(t){this.fistLabel="",this.labels={},this.useLabels={},this.quest=t.replace(/^[\n\r]+|[\n\r]+$/g,"").replace(/\/\*[\s\S.]+?\*\//g,"").split(/[\n\r]+/)}Le.prototype.init=function(){for(var t="",e=this.quest.length-1;e>=0;e--){var n=this.get(e);"_"==n.substr(0,1)&&"_"!=n.substr(1,1)?(this.quest[e-1]=this.quest[e-1]+n.substr(1),this.quest[e]=""):":"==n.substr(0,1)&&(t=n.substr(1).toLowerCase().trim(),":use_"==n.substr(0,5).toLowerCase()&&(this.useLabels[t]=e),this.labels[t]=e)}this.firstLabel=t},Le.prototype.getLabel=function(t){return t=t.toString().toLowerCase(),void 0!=this.labels[t]&&{name:t,pos:this.labels[t]}},Le.prototype.get=function(t){return void 0!=this.quest[t]&&this.quest[t]};var Ee=Le,Te=new Audio;function Oe(t){this.PLAYER_STATUS_NEXT=0,this.PLAYER_STATUS_END=1,this.PLAYER_STATUS_ANYKEY=2,this.PLAYER_STATUS_PAUSE=3,this.PLAYER_STATUS_INPUT=4,this.PLAYER_STATUS_QUIT=5,this.Quest=t,this.Parser=new d,this.text=[],this.buttons=[],this.links=[],this.inf=!1,this.procPosition=[],this.flow=0,this.flowStack=[],this.flowStack[this.flow]=[],this.lock=!1}Oe.prototype.continue=function(){this.play(),this.fin()},Oe.prototype.fin=function(){Game.getVar("music")&&this.playMusic(Game.getVar("music"),!0),this.status!=this.PLAYER_STATUS_NEXT&&Game.Client.render(),this.lock=!(this.status==this.PLAYER_STATUS_END||this.status==this.PLAYER_STATUS_PAUSE)},Oe.prototype.play=function(t){this.lock=!0,this.status=this.PLAYER_STATUS_NEXT,void 0!==t&&this.Parser.parse(t);while(this.status==this.PLAYER_STATUS_NEXT){0==this.flowStack[this.flow].length&&!1!==(t=this.next())&&this.Parser.parse(t);while(this.flowStack[this.flow].length>0&&this.status==this.PLAYER_STATUS_NEXT)this.Parser.parse(this.flowStack[this.flow].pop())}},Oe.prototype.next=function(t){t=this.Quest.get(Game.position);return Game.position++,!!t&&t.replace(/\t/g," ")},Oe.prototype.flowAdd=function(t){this.flowStack[this.flow].push(t)},Oe.prototype.common=function(){var t="common";0!==Game.getVar("common")&&(t=t+"_"+Game.getVar("common")),this.proc(t)&&(this.forgetProcs(),this.play())},Oe.prototype.action=function(t,e){if(this.lock)return!1;if(e){var n=this.links[t];this.links[t]=null}else for(var s in this.buttons)if(this.buttons[s].id==t){n=this.buttons[s].command,delete this.buttons[s];break}if(null!==n){var i=this.Quest.getLabel(n);i?this.btnAction(i.name):this.xbtnAction(n)}},Oe.prototype.btnAction=function(t){this.cls(),this.common(),this.goto(t,"btn")&&this.continue()},Oe.prototype.xbtnAction=function(t){this.common(),this.play(t+"&end"),this.fin()},Oe.prototype.useAction=function(t){if(this.lock)return!1;this.play("proc "+t+"&end"),this.fin()},Oe.prototype.anykeyAction=function(t){this.inf.length>0&&Game.setVar(this.inf,t),this.continue()},Oe.prototype.inputAction=function(t){Game.setVar(this.inf,t),this.continue()},Oe.prototype.setVar=function(t,e){if(Game.locked)return!1;if(t=t.trim(),"style_dos_textcolor"===t.toLowerCase()&&Game.setVar("style_textcolor",dosColorToHex(e)),"image"===t.toLowerCase()){var n=e;null!=files&&(void 0!==files[e]?n=e:void 0!==files[e+".png"]?n=e+".png":void 0!==files[e+".jpg"]?n=e+".jpg":void 0!==files[e+".gif"]&&(n=e+".gif")),this.image(n)}Game.setVar(t,e)},Oe.prototype.image=function(t){t&&this.print($('<img alt="Изображение" style="margin: 5px auto; display: block;">').attr("src",t).prop("outerHTML"),!0)},Oe.prototype.playMusic=function(t,e){var n;n=null===files?"quests/"+Game.name+"/"+t:files[t],t?Te.getAttribute("src")!=n&&(Te.src=n,e&&Te.addEventListener("ended",function(){Te.src=n,Te.play()},!1),Te.play()):Te.pause()},Oe.prototype.goto=function(t,e){var n=this.Quest.getLabel(t);return!!n&&("proc"!=e&&(Game.realCurrentLoc=n.name),"btn"!=e&&"goto"!=e||(Game.setVar("previous_loc",Game.getVar("current_loc")),Game.setVar("current_loc",t)),"btn"!=e&&"goto"!=e&&"proc"!=e||Game.setVar("count_"+n.name,Game.getVar("count_"+n.name)+1),Game.position=n.pos,this.flowStack[this.flow]=[],!0)},Oe.prototype.perkill=function(){Game.vars={},Game.items.forEach(function(t,e){Game.setVar(t,parseInt(e))})},Oe.prototype.cls=function(){this.text=[],this.buttons=[],this.links=[],Game.Client.render()},Oe.prototype.clsb=function(){this.buttons=[],this.links=[];for(var t=0;t<this.text.length;t++)this.text[t][0]=this.text[t][0].replace(/\<a.+?\>.+?\<\/a\>/gi,function(t){return Game.Client.disableLink(t)});Game.Client.clsb()},Oe.prototype.invkill=function(t){null!=t?Game.setItem(t,0):Game.items.forEach(function(t,e){Game.setItem(t,0)})},Oe.prototype.proc=function(t){return this.flow++,this.procPosition.push(Game.position),this.goto(t,"proc")?(this.flowStack[this.flow]=[],!0):(this.flow--,this.procPosition.pop(),!1)},Oe.prototype.end=function(){this.procPosition.length>0?(this.flowStack[this.flow].pop(),Game.position=this.procPosition.pop(),this.flow--):(this.flowStack[this.flow]=[],this.status=this.PLAYER_STATUS_END)},Oe.prototype.forgetProcs=function(){this.flowStack[0]=this.flowStack[this.flow],this.procPosition=[],this.flow=0},Oe.prototype.anykey=function(t){if(Game.locked)return!1;this.inf=t,this.status=this.PLAYER_STATUS_ANYKEY},Oe.prototype.pause=function(t){if(Game.locked)return!1;this.inf=t,this.status=this.PLAYER_STATUS_PAUSE},Oe.prototype.input=function(t){if(Game.locked)return!1;this.inf=t,this.status=this.PLAYER_STATUS_INPUT},Oe.prototype.quit=function(){this.status=this.PLAYER_STATUS_QUIT},Oe.prototype.invRemove=function(t,e){Game.removeItem(t,e)},Oe.prototype.invAdd=function(t,e){Game.addItem(t,e)},Oe.prototype.print=function(t,e){var n=null;if(isNaN(Game.getVar("style_textcolor")))n=Game.getVar("style_textcolor");else if(Game.getVar("style_textcolor")>0){var s=Game.getVar("style_textcolor")>>16&255,i=Game.getVar("style_textcolor")>>8&255,r=255&Game.getVar("style_textcolor");n="rgb("+r+", "+i+", "+s+")"}this.text.push([t,e,n])},Oe.prototype.btn=function(t,e){var n=this.buttons.length;this.buttons.push({id:n,command:t,desc:e})},Oe.prototype.link=function(t){var e=this.links.length;return this.links[e]=t,e};var Ve=Oe;function $e(){this.status=Game.Player.PLAYER_STATUS_NEXT,this.text=[],this.buttons=[]}$e.prototype.render=function(){this.status=Game.Player.status,this.text=Game.Player.text,this.buttons=Game.Player.buttons};var Ie=$e;function je(t){return console.log(t),t.prototype.next=function(t){t=this.Quest.get(Game.position);return Game.position++,-1!=t.indexOf(";")&&(t=t.substring(0,t.indexOf(";"))),!!t&&t.replace(/\t/g," ")},t.prototype.common=function(){this.proc("common")&&(this.forgetProcs(),this.play())},t.prototype.goto=function(t,e){var n=this.Quest.getLabel(t);return!!n&&("proc"!=e&&(Game.realCurrentLoc=n.name),"btn"!=e&&"goto"!=e||(Game.setVar("previous_loc",Game.getVar("current_loc")),Game.setVar("current_loc",t)),"btn"!=e&&"goto"!=e&&"proc"!=e||Game.setVar(n.name,Game.getVar(n.name)+1),Game.position=n.pos,this.flowStack[this.flow]=[],!0)},t}var Fe=je;function qe(t){return console.log(t),t.prototype.next=function(t){t=this.Quest.get(Game.position);return Game.position++,-1!=t.indexOf(";")&&(t=t.substring(0,t.indexOf(";"))),!!t&&t.replace(/\t/g," ")},t.prototype.goto=function(t,e){var n=this.Quest.getLabel(t);return!!n&&("proc"!=e&&(Game.realCurrentLoc=n.name),"btn"!=e&&"goto"!=e&&"proc"!=e||Game.setVar("count_"+n.name,Game.getVar("count_"+n.name)+1),Game.position=n.pos,this.flowStack[this.flow]=[],!0)},t}var Ue=qe;function Ne(t){this.locked=!1,this.items={},this.vars={tokens_delim:' ,"?!'},this.name=t,this.Player=null,this.Quest=null,this.Client=null,this.position=0,this.realCurrentLoc="",this.mode=0}Ne.prototype.init=function(t){this.Quest=new Ee(t),this.Quest.init(),this.realCurrentLoc=this.Quest.firstLabel,this.setVar("current_loc",this.Quest.firstLabel),this.setVar("previous_loc",this.Quest.firstLabel),this.mode="ripurq",this.mode&&("ripurq"==this.mode&&(this.Player=Fe(Ve)),"urqdos"==this.mode&&(this.Player=Ue(Ve))),this.Player=new Ve(this.Quest,this),this.Client=new Ie,this.Player.continue()},Ne.prototype.addItem=function(t,e){return this.setItem(t,this.getItem(t)+parseInt(e))},Ne.prototype.removeItem=function(t,e){return this.setItem(t,this.getItem(t)-parseInt(e))},Ne.prototype.setItem=function(t,e){if(this.locked)return!1;e=parseInt(e),e<=0?(delete this.items[t],this.setVar(t,0)):(this.items[t]=e,this.setVar(t,e))},Ne.prototype.getItem=function(t){return void 0==this.items[t]?0:this.items[t]},Ne.prototype.setVar=function(t,e){"inv_"==t.substr(0,4).toLowerCase()?(t=t.substr(4),this.setItem(t,e)):this.vars[t.toLowerCase()]=e},Ne.prototype.getVar=function(t){if(t=t.toLowerCase(),"inv_"==t.substr(0,4)&&(t=t.substr(4)),"rnd"==t)return Math.random();if("rnd"==t.substr(0,3))return Math.floor(Math.random()*parseInt(t.substr(3)))+1;if("time"==t){var e=new Date;return 3600*e.getHours()+60*e.getMinutes()+e.getSeconds()}if(t.split(" ").length>1){var n=t.split(" ")[0];if(!isNaN(n))return t=t.split(" ").slice(1).join(" ").trim(),this.vars[t]>=n}return void 0!=this.vars[t]?this.vars[t]:0},Ne.prototype.save=function(t){var e=new Date;localStorage.setItem(this.name+"_"+t.toString()+"_name",e.toLocaleDateString()+" "+e.toLocaleTimeString()),localStorage.setItem(this.name+"_"+t.toString()+"_data",JSON.stringify({status:this.Player.status,text:this.Player.text,buttons:this.Player.buttons,items:this.items,vars:this.vars,position:this.position,realCurrentLoc:this.realCurrentLoc}))},Ne.prototype.load=function(t){var e=JSON.parse(localStorage.getItem(this.name+"_"+t.toString()+"_data"));this.Player.status=e.status,this.Player.text=e.text,this.Player.buttons=e.buttons,this.items=e.items,this.vars=e.vars,this.position=e.position,this.realCurrentLoc=e.realCurrentLoc};var Ye=Ne,Re={name:"home",components:{Navbar:Ut,Buttons:Xt,Content:se,Input:he,Info:Ge},data:function(){return{questName:this.$route.params.name,Game:{},Client:{}}},computed:{},mounted:function(){var t=this;we.a.getBinaryContent("quests/".concat(this.questName,".zip"),function(e,n){mt.a.loadAsync(n).then(function(e){var n={},s=[];for(var i in e.files)if(!e.files[i].dir){var r=e.file(i);"qst"==r.name.split(".").pop().toLowerCase()?"_"==r.name.substr(0,1)||-1!=r.name.indexOf("/_")?s.unshift(r):s.push(r):"css"==r.name.split(".").pop().toLowerCase()?$("#additionalstyle").find("style").append(r.asBinary()):"js"==r.name.split(".").pop().toLowerCase()||r.async("base64").then(function(t){})}if(s.length>0){var a="";if(-1!=s[0].name.lastIndexOf("/")){var o=s[0].name.substring(0,s[0].name.lastIndexOf("/")+1);for(var i in n){var l=i.substr(o.length);n[l]=n[i],delete n[i]}}Promise.all(s.map(function(t){return t.async("binarystring")})).then(function(e){e.forEach(function(t){a+="\r\n".concat(ke.win2unicode(t))}),window.Game=new Ye(t.questName),t.Game=window.Game,window.Game.init(a),window.onbeforeunload=function(t){return"confirm please"},t.$set(t,"Client",t.Game.Client)})}})})},methods:{buttonClicked:function(t){this.Game.Player.action(t)}}},Qe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Navbar"),n("hr"),n("Content",{attrs:{content:t.Client.text}}),n("Buttons",{attrs:{buttons:t.Client.buttons},on:{clicked:t.buttonClicked}}),n("Info")],1)},Me=[],Be=!1,De=null,He=null,Xe=null,We=Object(a["a"])(Re,Qe,Me,Be,De,He,Xe),Je=We.exports;s["a"].use(S["a"]);var Ke=new S["a"]({routes:[{path:"/",name:"home",component:Et},{path:"/game/:name",name:"game",component:Je}]}),ze=n("ydGU");Object(ze["a"])("".concat("./","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}}),s["a"].config.productionTip=!1,new s["a"]({router:Ke,render:function(t){return t(C)}}).$mount("#app")}},[0]);
//# sourceMappingURL=app.1dcf9ce3.js.map